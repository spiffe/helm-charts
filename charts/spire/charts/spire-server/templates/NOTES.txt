Installed {{ .Chart.Name }}…

1. Get the currently registered SPIFFE entries from the server:

  kubectl exec -n {{ .Release.Namespace }} {{ include "spire-server.fullname" . }}-0 -c spire-server -- \
    spire-server entry show

{{- if eq (.Values.tornjak.enabled | toString) "true" }}

Installed {{ include "spire-tornjak.fullname" . }}…

### WARNING ###

Tornjak runs without authentication and is therefore NOT suitable to run in production environments.
Only use in test environments!

Access Tornjak:
   kubectl -n {{ include "spire-server.namespace" . }} port-forward service/{{ include "spire-tornjak.servicename" . }} {{ .Values.tornjak.config.service.port }}:10000
{{- if eq .Values.tornjak.config.connectionType "http" }}
HTTP:
  Open browser to: http://localhost:{{ .Values.tornjak.config.service.port }}
{{- else if eq .Values.tornjak.config.connectionType "tls" }}
TLS:
  Open browser to: https://localhost:{{ .Values.tornjak.config.service.port }}
  *** NOTE: You might get a security warning if using self-signed certificate
  or use curl:
  curl  --cacert CA/rootCA.crt https://localhost:{{ .Values.tornjak.config.service.port }}
{{- else if eq .Values.tornjak.config.connectionType "mtls" }}
mTLS:
  curl  --cacert CA/rootCA.crt --key client.key --cert client.crt https://localhost:{{ .Values.tornjak.config.service.port }}
{{- else }}
  ERROR! Incorrect value selected for "Values.tornjak.config.connectionType"
{{- end }}
{{- end }}
