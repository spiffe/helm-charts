Installed {{ .Chart.Name }}…

1. Get the currently registered SPIFFE entries from the server:

  kubectl exec -n {{ .Release.Namespace }} {{ include "spire-server.fullname" . }}-0 -c spire-server -- \
    spire-server entry show

{{- if eq (.Values.tornjak.enabled | toString) "true" }}

Installed {{ include "spire-tornjak.fullname" . }}…

### WARNING ###

Tornjak runs without authentication and is therefore NOT suitable to run in production environments.
Only use in test environments!

Access Tornjak:
{{- if eq (.Values.tornjak.config.http.enabled | toString) "true" }}
HTTP:
  kubectl -n {{ include "spire-server.namespace" . }} port-forward service/{{ include "spire-tornjak.backend" . }}-http {{ .Values.tornjak.config.http.service.port }}:{{ .Values.tornjak.config.http.port }}
  Open browser to: http://localhost:{{ .Values.tornjak.config.http.service.port }}
{{- end }}
{{- if eq (.Values.tornjak.config.tls.enabled | toString) "true" }}
TLS:
  kubectl -n {{ include "spire-server.namespace" . }} port-forward service/{{ include "spire-tornjak.backend" . }}-tls {{ .Values.tornjak.config.tls.service.port }}:{{ .Values.tornjak.config.tls.port }}
  Open browser to: https://localhost:{{ .Values.tornjak.config.tls.service.port }}
  *** NOTE: You might get a security warning if using self-signed certificate
{{- end }}
{{- if eq (.Values.tornjak.config.mtls.enabled | toString) "true" }}
mTLS:
  kubectl -n {{ include "spire-server.namespace" . }} port-forward service/{{ include "spire-tornjak.backend" . }}-mtls {{ .Values.tornjak.config.mtls.service.port }}:{{ .Values.tornjak.config.mtls.port }}
  curl  --cacert CA/rootCA.crt --key client.key --cert client.crt https://localhost:{{ .Values.tornjak.config.mtls.service.port }}
{{- end }}
{{- end }}
